<?xml version="1.0" encoding="utf-8"?>
<tnt-data-source
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../config/tnt-data-source.xsd">

    <parser name="CollectdStatsDataParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <property name="ReadLines" value="false"/>
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="type|type_instance" locator-type="Label" separator=" "/>
        <field name="Category" locator="plugin|plugin_instance" locator-type="Label" separator=" "/>
        <!--   <field name="ValueTypes" locator="dstypes" locator-type="Label"/> -->

        <field name="{$ValueName}" locator="values" locator-type="Label" value-type="${ValueType}">
            <field-locator name="ValueName" locator="dsnames" locator-type="Label" transparent="true"/>
            <field-locator name="ValueType" locator="dstypes" locator-type="Label" transparent="true"/>
        </field>

        <field name="StartTime" locator="time" locator-type="Label" datatype="Timestamp" units="Milliseconds"/>
    </parser>

    <parser name="CollectdReqBodyParser"
            class="com.jkoolcloud.tnt4j.streams.custom.parsers.SnapshotsJsonParser">
        <property name="ReadLines" value="false"/>
        <property name="ChildrenField" value="MsgBody"/>

        <field name="MsgBody" locator="$" locator-type="Label" transparent="true">
            <parser-ref name="CollectdStatsDataParser"/>
        </field>
        <field name="EventType" value="Activity"/>
    </parser>

    <parser name="CollectdReqParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="Transport" locator="ActivityTransport" locator-type="Label"/>
        <field name="MsgBody" locator="ActivityData" locator-type="Label">
            <parser-ref name="CollectdReqBodyParser"/>
        </field>
    </parser>

    <stream name="CollectdStream" class="com.jkoolcloud.tnt4j.streams.inputs.HttpStream">
        <property name="HaltIfNoParser" value="false"/>
        <property name="Port" value="9595"/>

        <parser-ref name="CollectdReqParser"/>
    </stream>
</tnt-data-source>
