<?xml version="1.0" encoding="utf-8"?>
<tnt-data-source
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/Nastel/tnt4j-streams/master/config/tnt-data-source.xsd">

    <parser name="JSONPayloadParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" locator="Runtime_node" locator-type="Label"/>
        <field name="date" locator="Date" locator-type="Label"/>
        <field name="since_last_dump(ms)" locator="since_last_ms" locator-type="Label" datatype="Number"/>
        <field name="Reason" locator="Reason" locator-type="Label"/>
    </parser>

    <!--                                        Properties                                                        -->
    <parser name="JSONPropertiesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Properties"/>
        <field name="StartTime" locator="start_timestamp" format="EEE MMM dd HH:mm:ss Z yyyy" locator-type="Label" locale="en-US"/>
        <field name="start_timestamp" locator="start_timestamp" locator-type="Label"/>
        <field name="autopilot_home" locator="autopilot_home" locator-type="Label"/>
        <field name="vm_id" locator="vm_id" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONJavaPropParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Java Properties"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONOperating_SystemParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Operating System"/>
        <field name="name" locator="os_name" locator-type="Label"/>
        <field name="version" locator="os_version" locator-type="Label"/>
        <field name="arch" locator="os_arch" locator-type="Label"/>
        <field name="cpus" locator="os_cpus" locator-type="Label" datatype="Number"/>
        <field name="user_name" locator="os_user_name" locator-type="Label"/>
        <field name="host_name" locator="os_host_name" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONJAVAParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="JAVA"/>
        <field name="home" locator="java_home" locator-type="Label"/>
        <field name="vendor" locator="java_vendor" locator-type="Label"/>
        <field name="version" locator="java_version" locator-type="Label"/>
        <field name="class_version" locator="java_class_version" locator-type="Label"/>
        <field name="class_path" locator="java_class_path" locator-type="Label"/>
        <field name="heap_max" locator="java_heap_max" locator-type="Label" datatype="Number"/>
        <field name="protocol_pkgs" locator="java_protocol_pkgs" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONInfoParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Info"/>
        <field name="product_component" locator="product_component" locator-type="Label"/>
        <field name="product_version" locator="product_version" locator-type="Label"/>
        <field name="product_csp" locator="product_csp" locator-type="Label"/>
        <field name="product_install" locator="product_install" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONRuntimeParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Runtime"/>
        <field name="domain_server_url" locator="domain_server_url" locator-type="Label"/>
        <field name="domain_server_name" locator="domain_server_name" locator-type="Label"/>
        <field name="server_mode_safe" locator="server_mode_safe" locator-type="Label" datatype="Binary"/>
        <field name="server_mode_demo" locator="server_mode_demo" locator-type="Label" datatype="Binary"/>
        <field name="server_log_dir" locator="server_log_dir" locator-type="Label"/>
        <field name="server_work_dir" locator="server_work_dir" locator-type="Label"/>
        <field name="server_prop_file" locator="server_prop_file" locator-type="Label"/>
        <field name="server_debug" locator="server_debug" locator-type="Label" datatype="Binary"/>
        <field name="server_auto_save" locator="server_auto_save" locator-type="Label" datatype="Binary"/>
        <field name="server_log_facts" locator="server_log_facts" locator-type="Label" datatype="Binary"/>
        <field name="server_concurrency" locator="server_concurrency" locator-type="Label" datatype="Number"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONGridParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Grid"/>
        <field name="server_grid" locator="server.grid" locator-type="Label"/>
        <field name="server_grid_enabled" locator="server_grid_enabled" locator-type="Label" datatype="Binary"/>
        <field name="server_grid_pri" locator="server_grid_pri" locator-type="Label" datatype="Number"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONJAASKRBParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="JAAS-KRB"/>
        <field name="jaas_login_config" locator="jaas_login_config" locator-type="Label"/>
        <field name="jaas_krb5_config" locator="jaas_krb5_config" locator-type="Label"/>
        <field name="jaas_krb5_realm" locator="jaas_krb5_realm" locator-type="Label"/>
        <field name="jaas_krb5_kdc" locator="jaas_krb5_kdc" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>
    <parser name="JSONDirectoryParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Directory"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>

    <parser name="JSONDomainPropertiesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Domain Properties"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="Category" value="Property"/>
        <field name="LogType" value="Property"/>
        <field name="ResourceType" value="GENERIC"/>
    </parser>
    <!--						End Properties 																	-->

    <!-- 						Start statistic 																-->
    <parser name="JSONActive_processesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Process Status"/>
        <field name="total_created" locator="total_created" locator-type="Label" datatype="Number"/>
        <field name="total_active" locator="total_active" locator-type="Label" datatype="Number"/>
        <field name="total_dropped" locator="total_dropped" locator-type="Label" datatype="Number"/>
        <field name="dropped_surge" locator="dropped_surge" locator-type="Label" datatype="Number"/>
        <field name="last_elapsed(ms)" locator="last_elapsed_ms" locator-type="Label" datatype="Timestamp"/>
        <field name="total_elapsed(ms)" locator="total_elapsed_ms" locator-type="Label" datatype="Timestamp"/>
        <field name="pool_size" locator="pool_size" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONSystem_MetricsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="System Metrics"/>
        <field name="Category" value="Statistic"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
    </parser>

    <parser name="JSONRule_Engine_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Rule Engine Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONExpire_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Expire Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONPubSub_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Pub/Sub Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONSensor_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Sensor Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONEvent_Log_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Event Log Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONSensor_SQL_LoggingParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Sensor SQL Logging"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONSensor_AggregationParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Sensor Aggregation"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONRecording_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Recording Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONExchange_ActivityParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Exchange Activity"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONLocalServiceParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Local Service"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <parser name="JSONLocalServicesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Local Services"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Statistic"/>
        <field name="Category" value="Statistic"/>
    </parser>

    <!-- 						End statistic 																	-->
    <!-- TODO gali buti neteisingas -->
    <parser name="JSONSql_bagParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="Sql_bag" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Logging"/>
        <field name="Category" value="Logging"/>
    </parser>

    <parser name="JSONThreadDumpParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
    </parser>

    <parser name="JSONSensorParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="Sensor.name" locator-type="Label"/>
        <field name="oid" locator="Sensor.oid" locator-type="Label"/>
        <field name="child_count" locator="Sensor.child_count" locator-type="Label" datatype="Number"/>
        <field name="fact_count" locator="Sensor.fact_count" locator-type="Label" datatype="Number"/>
        <field name="task_size" locator="Sensor.task_size" locator-type="Label" datatype="Number"/>
        <field name="sensor_value" locator="Sensor.sensor_value" locator-type="Label"/>
        <field name="fact_value" locator="Sensor.fact_value" locator-type="Label"/>
        <field name="color" locator="Sensor.color" locator-type="Label"/>
        <field name="severity" locator="Sensor.severity" locator-type="Label"/>
        <field name="task_active" locator="Sensor.is_task_active" locator-type="Label" datatype="Binary"/>
        <field name="care" locator="Sensor.is_care" locator-type="Label"/>
        <field name="armed" locator="Sensor.is_armed" locator-type="Label" datatype="Binary"/>
        <field name="ignored" locator="Sensor.is_ignored" locator-type="Label" datatype="Binary"/>
        <field name="persist" locator="Sensor.is_persist" locator-type="Label" datatype="Binary"/>
        <field name="root" locator="Sensor.is_root" locator-type="Label" datatype="Binary"/>
        <field name="owner" locator="Sensor.owner" locator-type="Label"/>
        <field name="scheme" locator="Sensor.scheme" locator-type="Label"/>
        <field name="delay" locator="Sensor.delay_ms" locator-type="Label" datatype="Number"/>
        <field name="action" locator="Sensor.action" locator-type="Label"/>
        <field name="event_mask" locator="Sensor.event_mask" locator-type="Label"/>
        <field name="envp" locator="Sensor.envp" locator-type="Label"/>
        <field name="resource_name" locator="Sensor.group" locator-type="Label"/>
        <field name="Category" locator="Sensor.group" locator-type="Label"/>
        <field name="Type" value="Sensor"/>
        <field name="ResourceType" value="RUNTIME"/>
        <field name="LogType" value="Sensor"/>
    </parser>

    <parser name="JSONFactParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="fact_name" locator-type="Label"/>
        <field name="Category" locator="group" locator-type="Label"/>
        <field name="LogType" value="Fact"/>
    </parser>

    <parser name="JSONTaskParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
    </parser>

    <parser name="JSONSensorChildsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <embedded-activity name="evnt0" locator="SensorData" locator-type="Label">
            <parser-ref name="JSONSensorParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="evnt1" locator="SensorData.FactData.Facts" locator-type="Label">
            <parser-ref name="JSONFactParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="evnt2" locator="SensorData.Tasks.tasks" locator-type="Label">
            <parser-ref name="JSONTaskParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONPipesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="filter" locator-type="Label"/>
        <field name="pipe_class" locator="pipe_class" locator-type="Label"/>
        <field name="usage" locator="usage" locator-type="Label"/>
        <field name="requests" locator="requests" locator-type="Label" datatype="Number"/>
        <field name="objects" locator="objects" locator-type="Label" datatype="Number"/>
        <field name="Type" value="Subscriber"/>
        <field name="ResourceType" value="RUNTIME"/>
        <field name="LogType" value="FactPipe"/>
        <field name="Category" value="FactPipe"/>
    </parser>

    <parser name="JSONListLocalServicesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="service" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Service"/>
        <field name="Category" value="Service"/>
    </parser>

    <parser name="JSONTopicsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="topic_key" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Topic"/>
        <field name="Category" value="Topic"/>
    </parser>

    <parser name="JSONLocalSessionsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="session" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Session"/>
        <field name="Category" value="Session"/>
    </parser>

    <parser name="JSONActiveCommunicationsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="localAddress" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Communication"/>
        <field name="Category" value="Communication"/>
    </parser>

    <parser name="JSONProcessesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Processes"/>
        <field name="Category" value="Processes"/>
    </parser>

    <parser name="JSONGCParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="GarbageCollector"/>
        <field name="Category" value="GarbageCollector"/>
    </parser>

    <parser name="JSONSensor_Logging_SessionsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="pool" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Logging"/>
        <field name="Category" value="Logging"/>
    </parser>

    <parser name="JSONThreadsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
    </parser>

    <parser name="JSONThread_Group_groupsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
    </parser>

    <parser name="JSONAnomaliesPropertiesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" value="Anomaly properties"/>
        <field name="result" locator="*" locator-type="Label"/>
        <field name="LogType" value="Anomalies"/>
        <field name="Category" value="Anomalies"/>
    </parser>

    <parser name="JSONTaskParser3" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="fact_name" locator-type="Label"/>
        <field name="Category" locator="group" locator-type="Label"/>
        <field name="LogType" value="Fact"/>
    </parser>

    <parser name="JSONFact_Subscribers_SubscribersParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="SNAPSHOT"/>
        <field name="EventName" locator="consumer" locator-type="Label"/>
        <field name="class" locator="class" locator-type="Label"/>
        <field name="count" locator="total_count" locator-type="Label" datatype="Number"/>
        <field name="sensor" locator="sensor" locator-type="Label"/>
        <field name="ResourceName" locator="subscriber" locator-type="Label"/>
        <field name="LogType" value="Subscriber"/>
        <field name="Category" value="Subscriber"/>
    </parser>
    <!--                                          END PROPERTIES 								-->

    <!--											EVENTS										-->

    <parser name="JSONListLocalServicesEventParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Local Service List"/>
        <field name="count" locator="total" locator-type="Label" datatype="Number"/>
        <field name="count_active_anomalies" locator="total_active_anomalies" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Service"/>
        <field name="Category" value="Service"/>
        <embedded-activity name="snap1" locator="Services" locator-type="Label">
            <parser-ref name="JSONListLocalServicesParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONThread_poolParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Thread pool"/>
        <field name="thread_class" locator="class" locator-type="Label"/>
        <field name="thread_pool_name" locator="name" locator-type="Label"/>
        <field name="max_priority" locator="max_priority" locator-type="Label" datatype="Number"/>
        <field name="threads_count" locator="total" locator-type="Label" datatype="Number"/>
        <field name="total_backlog" locator="total_backlog" locator-type="Label" datatype="Number"/>
        <field name="total_dropped" locator="total_dropped" locator-type="Label" datatype="Number"/>
        <field name="total_age(ms)" locator="total_age_ms" locator-type="Label" datatype="Number"/>
        <field name="pct_loss" locator="pct_loss" locator-type="Label" datatype="Number"/>
        <field name="total_rate/sec" locator="total_rate/sec" locator-type="Label" datatype="Number"/>
        <field name="total_processed" locator="total_processed" locator-type="Label" datatype="Number" format="#####,###"/>
        <field name="total_task_queue_size" locator="total_task_queue_size" locator-type="Label" datatype="Number"/>
        <field name="total_task_active" locator="total_task_active" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
        <field name="ResourceName" value="Thread"/>
        <embedded-activity name="snap1" locator="Threads" locator-type="Label">
            <parser-ref name="JSONThreadsParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="snap2" locator="Tasks" locator-type="Label">
            <parser-ref name="JSONTaskParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONThread_GroupParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" locator="name" locator-type="Label"/>
        <field name="thread_class" locator="class" locator-type="Label"/>
        <field name="max_priority" locator="max_priority" locator-type="Label" datatype="Number"/>
        <field name="threads_count" locator="thread_count" locator-type="Label" datatype="Number"/>
        <field name="active_group_count" locator="active_group_count" locator-type="Label" datatype="Number"/>
        <field name="ResourceName" value="Thread"/>
        <field name="ResourceType" value="RUNTIME"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
        <embedded-activity name="snap1" locator="groups" locator-type="Label">
            <parser-ref name="JSONThread_Group_groupsParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONFull_Java_thread_dumpParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Full Java thread dump"/>
        <field name="threads_count" locator="thread_count" locator-type="Label" datatype="Number"/>
        <field name="peak_threads" locator="peak_threads" locator-type="Label" datatype="Number"/>
        <field name="ResourceName" value="Thread"/>
        <field name="ResourceType" value="RUNTIME"/>
        <field name="LogType" value="Thread"/>
        <field name="Category" value="Thread"/>
        <embedded-activity name="evnt1" locator="Threads_info" locator-type="Label">
            <parser-ref name="JSONThreadDumpParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONFact_AnomaliesParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Fact Anomalies"/>
        <field name="count" locator="anomaly_count" locator-type="Label"/>
        <field name="LogType" value="Anomalies"/>
        <field name="Category" value="Anomalies"/>
        <embedded-activity name="evnt1" locator="anomalies" locator-type="Label">
            <parser-ref name="JSONAnomaliesPropertiesParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONFact_Logging_SessionsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Fact Logging Sessions"/>
        <field name="total" locator="total" locator-type="Label"/>
        <field name="url" locator="url" locator-type="Label"/>
        <field name="driver_class" locator="driver_class" locator-type="Label"/>
        <field name="driver_vendor" locator="driver_impl_vendor" locator-type="Label"/>
        <field name="driver_version" locator="driver_impl_version" locator-type="Label"/>
        <field name="LogType" value="Logging"/>
        <field name="Category" value="Logging"/>
        <embedded-activity name="snap1" locator="Sql_Bags" locator-type="Label">
            <parser-ref name="JSONSql_bagParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <!-- Sensors list -->
    <parser name="JSONSensor_Table_sensorsParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" locator="policy" locator-type="Label"/>
        <field name="policy_manager" locator="manager" locator-type="Label"/>
        <field name="sensor_count" locator="sensor_count" locator-type="Label" datatype="Number"/>
        <field name="owner" locator="owner" locator-type="Label"/>
        <field name="policy" locator="policy" locator-type="Label"/>
        <field name="ResourceName" locator="Sensor.group" locator-type="Label"/>
        <field name="LogType" value="Policy"/>
        <field name="Category" value="Policy"/>
        <field name="ResourceType" value="RUNTIME"/>
        <embedded-activity name="evnt0" locator="SensorData" locator-type="Label">
            <parser-ref name="JSONSensorParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="evnt1" locator="SensorData.FactData.Facts" locator-type="Label">
            <parser-ref name="JSONFactParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="evnt2" locator="SensorData.Tasks.tasks" locator-type="Label">
            <parser-ref name="JSONTaskParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="evnt3" locator="sensor_childs" locator-type="Label">
            <parser-ref name="JSONSensorChildsParser" aggregation="Merge"/>
        </embedded-activity>
    </parser>

    <parser name="JSONFact_SubscribersParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Fact Subscriber"/>
        <field name="subscribers_count" locator="subsc_count" locator-type="Label" datatype="Number"/>
        <field name="filter_count" locator="filter_count" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Subscriber"/>
        <field name="Category" value="Subscriber"/>
        <embedded-activity name="prop1" locator="Subscribers" locator-type="Label">
            <parser-ref name="JSONFact_Subscribers_SubscribersParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="evnt2" locator="pipes" locator-type="Label">
            <parser-ref name="JSONPipesParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONLocalCollectionParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Local Collection"/>
        <field name="total" locator="total" locator-type="Label"/>
        <field name="total_delivery_backlog" locator="total_delivery_backlog" locator-type="Label" datatype="Number"/>
        <field name="total_request_backlog" locator="total_request_backlog" locator-type="Label" datatype="Number"/>
        <field name="total_dropped" locator="total_dropped" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Topic"/>
        <field name="Category" value="Topics"/>
        <embedded-activity name="prop1" locator="Topics" locator-type="Label">
            <parser-ref name="JSONTopicsParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONLocalSessionsEventParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Session"/>
        <field name="count" locator="total" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Session"/>
        <field name="Category" value="Session"/>
        <embedded-activity name="evnt4" locator="Sessions" locator-type="Label">
            <parser-ref name="JSONLocalSessionsParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONActiveCommunicationsEventParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="Event"/>
        <field name="EventName" value="Active Communication"/>
        <field name="count" locator="total" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Communication"/>
        <field name="Category" value="Communication"/>
        <embedded-activity name="snap1" locator="communications" locator-type="Label">
            <parser-ref name="JSONActiveCommunicationsParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONGCEventParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="EVENT"/>
        <field name="EventName" value="Garbage Collector"/>
        <field name="count" locator="total" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="GarbageCollector"/>
        <field name="Category" value="GarbageCollector"/>
        <embedded-activity name="snap1" locator="GC" locator-type="Label">
            <parser-ref name="JSONGCParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>

    <parser name="JSONSensor_Logging_SessionsEventParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityMapParser">
        <field name="EventType" value="Event"/>
        <field name="EventName" value="Sensor Logging Session"/>
        <field name="count" locator="total" locator-type="Label" datatype="Number"/>
        <field name="LogType" value="Logging"/>
        <field name="Category" value="Logging"/>
        <embedded-activity name="snap1" locator="pools" locator-type="Label">
            <parser-ref name="JSONSensor_Logging_SessionsParser" aggregation="Relate"/>
        </embedded-activity>
    </parser>
    <!-- 												END EVENTS 									-->

    <parser name="ResponseParser" class="com.jkoolcloud.tnt4j.streams.parsers.ActivityJsonParser">
        <property name="ActivityDelim" value="EOF"/>

        <field name="EventType" value="ACTIVITY"/>
        <embedded-activity name="Result" locator="$.Dump_information" locator-type="Label">
            <parser-ref name="JSONPayloadParser" aggregation="Relate"/>
        </embedded-activity>

        <!--                            Properties                                              -->
        <embedded-activity name="Prop1" locator="$.Properties" locator-type="Label">
            <parser-ref name="JSONPropertiesParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop2" locator="$.Properties.Operating_System" locator-type="Label">
            <parser-ref name="JSONPropertiesParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop3" locator="$.Properties.JAVA" locator-type="Label">
            <parser-ref name="JSONJAVAParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop4" locator="$.Properties.Info" locator-type="Label">
            <parser-ref name="JSONInfoParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop5" locator="$.Properties.Runtime" locator-type="Label">
            <parser-ref name="JSONRuntimeParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop6" locator="$.Properties.Grid" locator-type="Label">
            <parser-ref name="JSONGridParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop7" locator="$.Properties.JAAS-KRB" locator-type="Label">
            <parser-ref name="JSONJAASKRBParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop8" locator="$.Properties.Directory" locator-type="Label">
            <parser-ref name="JSONDirectoryParser" aggregation="Relate"/>
        </embedded-activity>
        <embedded-activity name="Prop81" locator="$.Properties.Java_Properties" locator-type="Label">
            <parser-ref name="JSONJavaPropParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="Prop9" locator="$.Domain_Properties" locator-type="Label">
            <parser-ref name="JSONDomainPropertiesParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt1" locator="$.List_Local_Services" locator-type="Label">
            <parser-ref name="JSONListLocalServicesEventParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="Prop13" locator="$.Local_Services" locator-type="Label">
            <parser-ref name="JSONLocalServiceParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt3" locator="$.Local_Collections" locator-type="Label">
            <parser-ref name="JSONLocalCollectionParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt4" locator="$.Local_sessions" locator-type="Label">
            <parser-ref name="JSONLocalSessionsEventParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt5" locator="$.Active_communications" locator-type="Label">
            <parser-ref name="JSONActiveCommunicationsEventParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="Prop10" locator="$.Active_processes" locator-type="Label">
            <parser-ref name="JSONActive_processesParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="Prop11" locator="$.System_Metrics" locator-type="Label">
            <parser-ref name="JSONSystem_MetricsParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt7" locator="$.GC_Activity" locator-type="Label">
            <parser-ref name="JSONGCEventParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt8" locator="$.Rule_Engine_Activity" locator-type="Label">
            <parser-ref name="JSONRule_Engine_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt9" locator="$.Expire_Activity" locator-type="Label">
            <parser-ref name="JSONExpire_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt10" locator="$.'Pub/Sub_Activity'" locator-type="Label">
            <parser-ref name="JSONPubSub_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt11" locator="$.Sensor_Activity" locator-type="Label">
            <parser-ref name="JSONSensor_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt12" locator="$.Event_Log_Activity" locator-type="Label">
            <parser-ref name="JSONEvent_Log_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt13" locator="$.Sensor_SQL_Logging" locator-type="Label">
            <parser-ref name="JSONSensor_SQL_LoggingParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt14" locator="$.Sensor_Aggregation" locator-type="Label">
            <parser-ref name="JSONSensor_AggregationParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt15" locator="$.Recording_Activity" locator-type="Label">
            <parser-ref name="JSONRecording_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt16" locator="$.Exchange_Activity" locator-type="Label">
            <parser-ref name="JSONExchange_ActivityParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt20" locator="$.Fact_Logging_Sessions" locator-type="Label">
            <parser-ref name="JSONFact_Logging_SessionsParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt18" locator="$.Sensor_Logging_Sessions" locator-type="Label">
            <parser-ref name="JSONSensor_Logging_SessionsEventParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt19" locator="$.Thread_pool" locator-type="Label">
            <parser-ref name="JSONThread_poolParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt21" locator="$.Thread_Group" locator-type="Label">
            <parser-ref name="JSONThread_GroupParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt25" locator="$.Full_Java_thread_dump" locator-type="Label">
            <parser-ref name="JSONFull_Java_thread_dumpParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt26" locator="$.Fact_Anomalies" locator-type="Label">
            <parser-ref name="JSONFact_AnomaliesParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt27" locator="$.Sensor_Table.sensors" locator-type="Label">
            <parser-ref name="JSONSensor_Table_sensorsParser" aggregation="Relate"/>
        </embedded-activity>

        <embedded-activity name="evnt28" locator="$.Fact_Subscribers" locator-type="Label">
            <parser-ref name="JSONFact_SubscribersParser" aggregation="Relate"/>
        </embedded-activity>

    </parser>

    <stream name="AutoPilotM6Dump" class="com.jkoolcloud.tnt4j.streams.inputs.CharacterStream">
        <property name="FileName" value="./tnt4j-streams-core/samples/nastel-runtime-dump/CEP_DEMO-8756@RNIKULA-PC-json-12,52,09.nrd"/>
        <property name="SplitRelatives" value="false"/>

        <parser-ref name="ResponseParser"/>
    </stream>

</tnt-data-source>
