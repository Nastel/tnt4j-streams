<project name="tnt4j-streams" default="all" basedir=".">

    <echo message="Processing ${ant.project.name}${line.separator}" level="info"/>

    <condition property="isWindows">
        <os family="windows"/>
    </condition>

    <condition property="isUnix">
        <os family="unix"/>
    </condition>

    <target name="clean" depends="mvn_windows_clean, mvn_unix_clean"/>

    <target name="rebuild" depends="mvn_windows_init, mvn_unix_init, mvn_windows_build, mvn_unix_build"/>

    <target name="all" depends="rebuild"/>

    <target name="mvn_windows_clean" if="isWindows">
        <exec dir="." executable="cmd">
            <arg line="/c mvn clean"/>
        </exec>
    </target>

    <target name="mvn_unix_clean" if="isUnix">
        <exec dir="." executable="sh">
            <arg line="-c 'mvn clean'"/>
        </exec>
    </target>

	<target name="mvn_windows_init" if="isWindows">
        <exec dir="." executable="cmd">
            <arg line="/c mvn install:install-file -Dfile=../build/tnt4j/tnt4j-api.jar -DgroupId=com.nastel.jkool.tnt4j -DartifactId=tnt4j-api -Dversion=1.0.0 -Dpackaging=jar"/>
        </exec>
        <exec dir="." executable="cmd">
            <arg line="/c mvn install:install-file -Dfile=../build/jesl/jkool-jesl.jar -DgroupId=com.nastel.jkool.tnt4j -DartifactId=jkool-jesl -Dversion=1.0.0 -Dpackaging=jar"/>
        </exec>
	</target>

	<target name="mvn_unix_init" if="isUnix">
        <exec dir="." executable="cmd">
            <arg line="-c 'mvn install:install-file -Dfile=../build/tnt4j/tnt4j-api.jar -DgroupId=com.nastel.jkool.tnt4j -DartifactId=tnt4j-api -Dversion=1.0.0 -Dpackaging=jar'"/>
        </exec>
        <exec dir="." executable="cmd">
            <arg line="-c 'mvn install:install-file -Dfile=../build/jesl/jkool-jesl.jar -DgroupId=com.nastel.jkool.tnt4j -DartifactId=jkool-jesl -Dversion=1.0.0 -Dpackaging=jar'"/>
        </exec>
	</target>

    <target name="mvn_windows_build" if="isWindows">
        <exec dir="." executable="cmd">
            <arg line="/c mvn clean package javadoc:aggregate install -DskipTests"/>
        </exec>
    </target>

    <target name="mvn_unix_build" if="isUnix">
        <exec dir="." executable="sh">
            <arg line="-c 'mvn clean package javadoc:aggregate install -DskipTests'"/>
        </exec>
    </target>

</project>
